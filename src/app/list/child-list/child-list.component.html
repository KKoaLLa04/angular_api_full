<div class="container">
    <h1 class="py-3 text-center">SHOW API LIST</h1>
    
    <!-- <a routerLink="/add-component" class="btn btn-success">Thêm mới</a> -->
    <button type="button" class="btn btn-primary" (click)="openModal(template)">Create template modal</button>
 
    <ng-template #template>
      <div class="modal-header">
        <h4 class="modal-title pull-left">Thêm học sinh mới</h4>
        <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="modalRef?.hide()">
          <span aria-hidden="true" class="visually-hidden">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="" [formGroup]="username" (ngSubmit)="changeDataToParent()">
          <div class="row">
              <div class="col-12 my-3">
                  <input type="text" placeholder="Avatar..." class="form-control" formControlName="avatar">
                  <div *ngIf="username.controls['avatar'].hasError('required') && username.controls['avatar'].touched" class="alert alert-danger">
                      avatar bat buoc phai nhap
                  </div>
              </div>
      
              <div class="col-12 mb-3">
                  <input type="text" placeholder="name..." class="form-control" formControlName="name">
                  <div *ngIf="username.controls['name'].hasError('required') && username.controls['name'].touched" class="alert alert-danger">
                      name bat buoc phai nhap
                  </div>
              </div>
      
              <div class="col-12 mb-3">
                  <input type="text" placeholder="username..." class="form-control" formControlName="username">
                  <div *ngIf="username.controls['username'].hasError('required') && username.controls['username'].touched" class="alert alert-danger">
                      username bat buoc phai nhap
                  </div>
              </div>
      
              <div class="col-12 mb-3">
                  <input type="radio" value="0" formControlName="gender" id="female" class="mx-1"> <label for="female">Female</label>
                  <input type="radio" value="1" formControlName="gender" id="male" class="mx-1"> <label for="male">male</label>
                  <div *ngIf="username.controls['gender'].hasError('required') && username.controls['gender'].touched" class="alert alert-danger">
                      gender bat buoc phai chon
                  </div>
              </div>

              <div class="col-12 mb-3">
                <!-- <input type="text" placeholder="date_of_study..." class="form-control" formControlName="date_of_study"> -->
                <select class="form-control" formControlName="date_of_study">
                  <option value="" selected>Chọn năm học</option>
                  <option value="1">2024</option>
                  <option value="2">2023</option>
                  <option value="3">2022</option>
                </select>
                <div *ngIf="username.controls['date_of_study'].hasError('required') && username.controls['date_of_study'].touched" class="alert alert-danger">
                    Năm học bat buoc phai nhap
                </div>
              </div>

              <div class="col-12 mb-3">
                <input type="checkbox" value="1" formControlName="block" id="block1" class="mx-1"> <label for="block1">Kỳ 1</label>
                <input type="checkbox" value="2" formControlName="block" id="block2" class="mx-2"> <label for="block2">Kỳ 2</label>
                <input type="checkbox" value="3" formControlName="block" id="block3" class="mx-3"> <label for="block3">Kỳ 3</label>
                <input type="checkbox" value="4" formControlName="block" id="block4" class="mx-4"> <label for="block4">Kỳ 4</label>
                <div *ngIf="username.controls['block'].hasError('required') && username.controls['block'].touched" class="alert alert-danger">
                    block bat buoc phai nhap
                </div>
              </div>

              <div class="col-12 mb-3">
                <input type="text" placeholder="status..." class="form-control" formControlName="status">
                <div *ngIf="username.controls['status'].hasError('required') && username.controls['status'].touched" class="alert alert-danger">
                    status bat buoc phai nhap
                </div>
              </div>

              <div class="col-12 mb-3">
                <input type="password" placeholder="password..." class="form-control" formControlName="password">
                <div *ngIf="username.controls['password'].hasError('required') && username.controls['password'].touched" class="alert alert-danger">
                    password bat buoc phai nhap
                </div>
              </div>
              
              <div class="col-12 mb-3">
                <input type="number" placeholder="age..." class="form-control" formControlName="age">
                <div *ngIf="username.controls['age'].hasError('required') && username.controls['age'].touched" class="alert alert-danger">
                    age bat buoc phai nhap
                </div>
                <div *ngIf="username.controls['age'].hasError('minLength') && username.controls['age'].touched" class="alert alert-danger">
                  age bat buoc phai lớn hơn hoặc bằng 1 tuổi
                </div>
                <div *ngIf="username.controls['age'].hasError('maxLength') && username.controls['age'].touched" class="alert alert-danger">
                  age không được lớn hơn 100 tuổi
                </div>
              </div>
          </div>
      
          <button type="submit" class="btn btn-primary" (click)="submitForm()">Thêm mới</button>
      </form>
      </div>
    </ng-template>
    <hr>
    
    <app-search (searchTextChange)="onFilterSearchText($event)"></app-search>
    <hr>
    <table class="table table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th width="15%">Avatar</th>
          <th>name</th>
          <th>username</th>
          <th>gender</th>
          <th>age</th>
          <th>date of study</th>
          <th>block</th>
          <th>status</th>
          <th>edit</th>
          <th>delete</th>
        </tr>
      </thead>
  
      <tbody>
          <tr *ngFor="let item of data, let i = index">
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{i+1}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)"><img src="{{item.avatar}}" width="100%"/></td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.name}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.username}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.gender}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.age}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.date_of_study}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.block}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)">{{item.status}}</td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)"><a class="btn btn-warning" routerLink="/edit/{{item.id}}">Edit</a></td>
            <td *ngIf="(searchText==='' || item.name.toLowerCase().includes(searchText) || item.username.toLowerCase().includes(searchText)) && checkDisplayList(i+1)"><button (click)="deleteUser(item.id)"  class="btn btn-danger">Delete</button></td>
          </tr>
      </tbody>
    </table>

    <app-pagination [currentPage]="currentPageData" [totalPages]="totalPagesData" (pageChange)="pageChange($event)"></app-pagination>
  </div>